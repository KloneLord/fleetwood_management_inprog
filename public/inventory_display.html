<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inventory Display</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
<div class="container mt-5">
  <h1>Inventory Item Details</h1>
  <div id="inventoryDetails" class="mt-4">
    <!-- Inventory details will be dynamically populated here -->
  </div>
  <button onclick="goBack()" class="btn btn-secondary mt-3">Back to List</button>
</div>

<script>
  document.addEventListener('DOMContentLoaded', async () => {
    const urlParams = new URLSearchParams(window.location.search);
    const inventoryId = urlParams.get('id');

    if (!inventoryId) {
      alert('No inventory ID provided.');
      return;
    }

    const inventoryDetailsContainer = document.getElementById('inventoryDetails');

    // Fetch inventory item details
    const fetchInventoryDetails = async (id) => {
      try {
        const response = await axios.get(`/api/inventories/${id}`);
        return response.data; // Inventory item data
      } catch (error) {
        console.error('Error fetching inventory details:', error);
        alert('Failed to load inventory details.');
      }
    };

    // Render inventory details
    const renderInventoryDetails = async () => {
      const inventory = await fetchInventoryDetails(inventoryId);

      if (!inventory) {
        inventoryDetailsContainer.innerHTML = '<p class="text-danger">Inventory item not found.</p>';
        return;
      }

      inventoryDetailsContainer.innerHTML = `
        <table class="table table-bordered">
          <tbody>
            <tr><th>Item ID</th><td>${inventory.itemID || 'N/A'}</td></tr>
            <tr><th>Description</th><td>${inventory.itemDescription || 'N/A'}</td></tr>
            <tr><th>Category</th><td>${inventory.category || 'N/A'}</td></tr>
            <tr><th>Subcategory</th><td>${inventory.subcategory || 'N/A'}</td></tr>
            <tr><th>Current Stock Level</th><td>${inventory.currentStockLevel || 0}</td></tr>
            <tr><th>On Order</th><td>${inventory.onOrder || 0}</td></tr>
            <tr><th>Supplier Name</th><td>${inventory.supplierName || 'N/A'}</td></tr>
            <tr><th>Purchase Price</th><td>$${inventory.purchasePrice?.toFixed(2) || '0.00'}</td></tr>
            <tr><th>Markup (%)</th><td>${inventory.markupAmount || 0}</td></tr>
            <tr><th>Custom Sell Price</th><td>$${inventory.customSellPrice?.toFixed(2) || '0.00'}</td></tr>
            <tr><th>Finalized Sell Price</th><td>$${inventory.finalizedSellPrice?.toFixed(2) || '0.00'}</td></tr>
            <tr><th>Location</th><td>${inventory.location || 'N/A'}</td></tr>
            <tr><th>Detailed Location</th><td>${inventory.detailLoc || 'N/A'}</td></tr>
            <tr><th>Barcode</th><td>${inventory.barcode || 'N/A'}</td></tr>
            <tr><th>QR Code</th><td>${inventory.qrCode || 'N/A'}</td></tr>
            <tr><th>Reorder Point</th><td>${inventory.reorderPoint || 0}</td></tr>
            <tr><th>Alert Threshold</th><td>${inventory.alertThreshold || 0}</td></tr>
            <tr><th>Is Active</th><td>${inventory.isActive ? 'Yes' : 'No'}</td></tr>
            <tr><th>Notes</th><td>${inventory.notes || 'N/A'}</td></tr>
            <tr><th>Total Bought</th><td>${inventory.totalBought || 0}</td></tr>
            <tr><th>Total Sold</th><td>${inventory.totalSold || 0}</td></tr>
            <tr><th>Last Edited By</th><td>${inventory.lastEdited || 'N/A'}</td></tr>
            <tr><th>Last Edited Time</th><td>${new Date(inventory.editTime).toLocaleString() || 'N/A'}</td></tr>
          </tbody>
        </table>
      `;
    };

    // Back to list function
    window.goBack = () => {
      window.location.href = '/inventory_list.html';
    };

    // Load and render inventory details
    await renderInventoryDetails();
  });
</script>
</body>
</html>
